{% extends "base.html" %}
{% block title %}Upload Audio{% endblock %}
{% block content %}

<div class="row justify-content-center">
  <div class="col-lg-6 col-md-8">
    <div class="card shadow-lg border-0 rounded-4">
      <div class="card-body p-4">
        
        <!-- Header -->
        <div class="text-center mb-4">
          <i class="fas fa-upload text-primary" style="font-size: 3rem;"></i>
          <h3 class="fw-bold text-primary mt-2">Upload Audio</h3>
          <p class="text-muted small">MP3 or WAV files only â€” Max 50MB</p>
        </div>

        <!-- Upload Form -->
        <form method="POST" enctype="multipart/form-data" id="uploadForm" class="needs-validation" novalidate>
          <div class="mb-4">
            <label for="file" class="form-label fw-semibold">
              <i class="fas fa-music me-2 text-primary"></i>Choose Your Audio File
            </label>
            <input type="file" 
                   class="form-control form-control-lg" 
                   id="file" 
                   name="file" 
                   accept=".mp3,.wav" 
                   required>
            <div class="invalid-feedback">Please select an MP3 or WAV file.</div>
          </div>

          <!-- Progress Bar -->
          <div class="progress mb-3 d-none" id="uploadProgressContainer" style="height: 8px;">
            <div class="progress-bar bg-primary" id="uploadProgress" style="width: 0%;"></div>
          </div>

          <!-- Buttons -->
          <div class="d-grid">
            <button type="submit" class="btn btn-primary btn-lg fw-semibold">
              <i class="fas fa-cloud-upload-alt me-2"></i>Upload & Transcribe
            </button>
            <a href="{{ url_for('dashboard') }}" class="btn btn-outline-secondary mt-2">
              <i class="fas fa-arrow-left me-2"></i>Back to Dashboard
            </a>
          </div>
        </form>

      </div>
    </div>
  </div>
</div>

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- JavaScript Enhancements -->
<script>
(function () {
  'use strict';
  const form = document.getElementById('uploadForm');
  const progressContainer = document.getElementById('uploadProgressContainer');
  const progressBar = document.getElementById('uploadProgress');

  // Bootstrap validation
  form.addEventListener('submit', function (event) {
    if (!form.checkValidity()) {
      event.preventDefault();
      event.stopPropagation();
    } else {
      // Show progress bar on valid submit
      progressContainer.classList.remove('d-none');
      let progress = 0;
      const interval = setInterval(() => {
        if (progress < 90) {
          progress += 10;
          progressBar.style.width = progress + '%';
        } else {
          clearInterval(interval);
        }
      }, 300);
    }
    form.classList.add('was-validated');
  }, false);
})();
</script>

{% endblock %}